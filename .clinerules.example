# Development Server Rules (the-dev-server MCP)

## ğŸ¯ MANDATORY: PM2 Process Management

### ALWAYS FIRST STEPS
When I talk about dev servers:
1. Call: `the-dev-server` MCP â†’ `get-managed-processes()`
2. If a service is missing, use `register-managed-process()` before doing anything else.

### WHEN I SAY...

**"Start / stop / restart the server"**
â†’ Use `start-managed-process()` / `stop-managed-process()` / `restart-managed-process()`.

**"Change its config"**
â†’ Call `update-managed-process({...changes, applyToPm2: true})`.

**"It's broken"**
â†’ Run the `diagnose-server` prompt, follow instructions, and tail logs with `read-managed-process-logs()`.

**"Show me what's running"**
â†’ Call `get-managed-processes()` (and optionally `get-pm2-status()` for full PM2 view).

**"Remove this service"**
â†’ Call `delete-managed-process({ name, deleteFromPm2: true })`.

### NEVER DO THIS
- âŒ Run raw `pm2` CLI commands manually
- âŒ Assume a process exists without checking the registry
- âŒ Edit `.the-dev-server-state.json` by hand
- âŒ Leave orphaned PM2 processes

### ALWAYS DO THIS
- âœ… Register processes before trying to start them
- âœ… Use MCP lifecycle tools for every start/stop/restart/delete
- âœ… Confirm outcomes with `get-managed-processes()`
- âœ… Tail logs via MCP tools
- âœ… Trust the MCP as the single source of truth

---

## ğŸ“‹ Project-Specific Info

**Project Name:** [Auto-detected by MCP]  
**Typical Port:** Managed via environment variables in process config  
**Server Tech:** Describe when registering (e.g., Next.js, Vite)  
**Build Command:** [Your command, e.g., `npm run build`]  
**Start Command:** Register with `script` + `args` (e.g., `npm run dev`)  
**Log Location:** Access via `read-managed-process-logs`

---

## ğŸš€ Quick Reference

```
User: "Is it running?"
You:  1. get-managed-processes()
      2. Report registry + PM2 status

User: "Start it"
You:  1. start-managed-process({ name })
      2. Confirm via get-managed-processes()

User: "It's broken"
You:  1. diagnose-server prompt
      2. read-managed-process-logs({ type: "error" })
```

---

**Remember: This MCP exists to eliminate server confusion. Use it religiously!**
